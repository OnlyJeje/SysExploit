#include "include.h"

int	main(int ac, char **av)
{
  pthread_t thread1;
  pthread_t thread2;
  
  int r1;
  int r2;
  
  threadMutexInit(&mutex, NULL);
  
  if ((r1 = threadCreate(&thread1, NULL, &function, NULL)))
    {
      printf("%s\n", "Impossible de créer le thread 1");
      return (-1);
    }
  
  if ((r2 = threadCreate(&thread2, NULL, &function, NULL)))
    {
      printf("%s\n", "Impossible de créer le thread 2");
      return (-1);
    }
  
  threadJoin(thread1, NULL);
  threadJoin(thread2, NULL);

  
  threadMutexDestroy(&mutex);
}

void *function()
{
  while(i < 20)
    {
      threadMutexLock(&mutex);
      i++;
      printf("THREAD: %u\nCOMPTEUR: %d\n--------------------------\n", (uint)threadSelf(), i);
      threadMutexUnlock(&mutex);
      sleep(1);
    }
}
      
