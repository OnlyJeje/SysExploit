#include "include.h"

int main(int ac, char **av)
{
  int server_socket;
  int fd;
  char c;
  struct sockaddr_in sockserver;
  struct stat stat_buf;
  off_t offset = 0; 
  if (ac < 2)
    {
      printf("%s\n", "Veuillez entrer le nom d'un fichier.");
      return (-1);
    }
  
  sockserver.sin_family = AF_INET;
  sockserver.sin_port = htons(1234);
  inet_aton("127.0.0.1", &sockserver.sin_addr);
  
  server_socket = socket(AF_INET, SOCK_STREAM,0);
  connect(server_socket, (struct sockaddr*)&sockserver, sizeof(sockserver));
  
  fd = open(av[1], O_RDONLY); 
  fstat(fd, &stat_buf);
  
 
  sendfile(server_socket, fd, &offset, stat_buf.st_size);

  close(fd);
  close(server_socket);
}
